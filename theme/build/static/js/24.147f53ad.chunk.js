(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{457:function(e,t,n){"use strict";n.r(t);var r=n(2),o=n.n(r),a=n(7),s=n(19),c=n(20),i=n(22),p=n(21),u=n(23),l=n(47),d=n(1),h=n.n(d),m=(n(9),n(29)),f=n(6),b=n.n(f),y=n(10),g=n.n(y),v=n(45),w=n(0),j=n(146),k=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(i.a)(this,Object(p.a)(t).call(this,e))).state={currency:""},n.openCheckout=n.openCheckout.bind(Object(l.a)(Object(l.a)(n))),n.processTranscation=n.processTranscation.bind(Object(l.a)(Object(l.a)(n))),n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=document.createElement("script");e.src="https://checkout.razorpay.com/v1/checkout.js",e.async=!0,document.body.appendChild(e)}},{key:"openCheckout",value:function(){var e=this;if(!1===this.props.readTnc)this.props.readTncThenBuy();else{g.a.get("sellerid");var t=this.props.package_id;if(g.a.get("sellerid")){var n={currency:(this.props.currency,this.props.currency),sellerid:g.a.get("sellerid"),amount:this.props.amount};b.a.post("".concat(v.d,"/api/membership/createSubscription"),n).then(function(){var n=Object(a.a)(o.a.mark(function n(r){var s,c,i,p,u;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return 201===r.status&&window.location.reload(),console.log(r),s=r.data,c=e.props.user.mobile,n.next=6,e.props.user.email;case 6:i=n.sent,p=e.props.user.name,u={key:s.key_id,subscription_id:s.subscription_id,name:"Beldara.com",description:"Beldara Monthly Subscription",image:"https://img.beldara.com/images/BelDara-logo.png",handler:function(e){console.log(e);var n={payment_id:e.razorpay_payment_id,subscription_id:e.razorpay_subscription_id,package_id:t,sellerid:localStorage.getItem("sellerid")};b.a.post("".concat(v.d,"/api/membership/successSubscription"),n).then(function(){var e=Object(a.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t),b.a.post("".concat(w.d,"/common/send_invoice.php"),n,{headers:{"Content-Type":"multipart/form-data"}}).then(function(){var e=Object(a.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.location.reload(),console.log(t);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){var t=e.response;return Promise.reject(t)});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){var t=e.response;return Promise.reject(t)})},prefill:{name:p,email:i,mobile:c},theme:{color:"#F37254"}},new window.Razorpay(u).open();case 11:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()).catch(function(e){console.log("error",e);var t=e.response;return Promise.reject(t)})}else this.props.openLoginModal()}}},{key:"processTranscation",value:function(){if(!1===this.props.readTnc)return this.props.readTncThenBuy();if(console.log("monthly sub",g.a.get("sellerid")),g.a.get("sellerid")){var e={name:this.props.user.name,email:this.props.user.email,mobile:this.props.user.mobile,sellerid:g.a.get("sellerid")?JSON.parse(g.a.get("sellerid")):g.a.get("sellerid")};b.a.post("".concat(v.d,"/api/membership/emandate/createCustomerId"),e,{headers:{"Content-Type":"application/json"}}).then(function(){var e=Object(a.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t),window.location.href="/processtranscation/"+t.data.id;case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){var t=e.response;return Promise.reject(t)})}else this.props.openLoginModal()}},{key:"render",value:function(){return console.log(this.props),h.a.createElement("div",{className:"justify-content-center text-center"},h.a.createElement("button",{className:"btn getLogin",onClick:this.processTranscation,id:"monthly-subs"},"Choose Monthly Subscription"))}}]),t}(d.Component);t.default=Object(j.a)(Object(m.connect)(function(e){return{currency:e.data.symbol,user:e.user.user}})(k))}}]);
//# sourceMappingURL=24.147f53ad.chunk.js.map