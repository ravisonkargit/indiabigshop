(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{297:function(e,a,t){},802:function(e,a,t){"use strict";t.r(a);var n=t(2),r=t.n(n),c=t(7),o=t(19),s=t(20),i=t(22),l=t(21),d=t(23),m=t(47),u=t(1),p=t.n(u),b=t(743),h=(t(297),t(6)),y=t.n(h),f=t(45),v=t(0),g=t(29),N=t(195),k=t(741),E=t(10),w=t.n(E),C=t(9),_=t.n(C),S=t(8),O="emandate",j=[{value:"Savings",label:"Savings"},{value:"Current",label:"Current"}],T=function(e){function a(e){var t;return Object(o.a)(this,a),(t=Object(i.a)(this,Object(l.a)(a).call(this,e))).handleChange=function(e){t.setState({selectedOption:e}),console.log("Option selected:",e)},t.onSubNetbanking=function(e){"paytm"==e?t.paytmPayment(e,"netbanking",O):t.netBankingSubmit(e,"netbanking",O)},t.state={currency:"",selectedOption:null,paymentGroup:"razorpay",docContent:"",is_subscribed:!1},t.checkout=t.checkout.bind(Object(m.a)(Object(m.a)(t))),t.openCheckout=t.openCheckout.bind(Object(m.a)(Object(m.a)(t))),t.netBankingSubmit=t.netBankingSubmit.bind(Object(m.a)(Object(m.a)(t))),t.paytmPayment=t.paytmPayment.bind(Object(m.a)(Object(m.a)(t))),t}return Object(d.a)(a,e),Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=document.createElement("script");e.src="https://checkout.razorpay.com/v1/checkout.js",e.async=!0,document.body.appendChild(e)}},{key:"componentDidUpdate",value:function(){if(this.state.is_subscribed)var e=setInterval(function(){window.location.href=window.location.origin,clearInterval(e)},1e3)}},{key:"checkout",value:function(){var e={key:"rzp_test_7vcRhUW0TOK8JG",order_id:"order_ECfJKvlNOylRWE",customer_id:"cust_ECfHSGMMIetkDf",recurring:"1",handler:function(e){alert(e.razorpay_payment_id),alert(e.razorpay_order_id),alert(e.razorpay_signature)},notes:{"note_key 1":"Beam me up Scotty","note_key 2":"Tea. Earl Gray. Hot."},theme:{color:"#F37254"}};new window.Razorpay(e).open()}},{key:"openCheckout",value:function(){var e=this;console.log("openCheckout: ",this.props,this.props.package_id,71);var a=localStorage.getItem("sellerid"),t=this.props.package_id;if(a){var n={currency:(this.props.currency,this.props.currency),sellerid:localStorage.getItem("sellerid"),amount:this.props.amount};y.a.post("".concat(f.d,"/api/membership/createSubscription"),n).then(function(){var a=Object(c.a)(r.a.mark(function a(o){var s,i,l,d,m;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return 201===o.status&&window.location.reload(),console.log(o,95),s=o.data,i=e.props.user.mobile,a.next=6,e.props.user.email;case 6:l=a.sent,d=e.props.user.name,m={key:s.key_id,subscription_id:s.subscription_id,name:"Beldara.com",description:"Beldara Monthly Subscription",image:"https://img.beldara.com/images/BelDara-logo.png",handler:function(e){console.log(e);var a={payment_id:e.razorpay_payment_id,subscription_id:e.razorpay_subscription_id,package_id:t,sellerid:localStorage.getItem("sellerid")};y.a.post("".concat(f.d,"/api/membership/successSubscription"),a).then(function(){var e=Object(c.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t),y.a.post("".concat(v.d,"/common/send_invoice.php"),a,{headers:{"Content-Type":"multipart/form-data"}}).then(function(){var e=Object(c.a)(r.a.mark(function e(a){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.location.reload(),console.log(a);case 2:case"end":return e.stop()}},e)}));return function(a){return e.apply(this,arguments)}}()).catch(function(e){window.location.reload();var a=e.response;return Promise.reject(a)});case 2:case"end":return e.stop()}},e)}));return function(a){return e.apply(this,arguments)}}()).catch(function(e){var a=e.response;return Promise.reject(a)})},prefill:{name:d,email:l,mobile:i},theme:{color:"#F37254"}},console.log(n,m,147),new window.Razorpay(m).open();case 12:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()).catch(function(e){var a=e.response;return Promise.reject(a)})}else this.props.openLoginModal()}},{key:"paytmPayment",value:function(e,a,t){var n=this;console.log(e,t);var o={sellerid:JSON.parse(this.props.user.sellerid),currency:Object(S.s)("currency")?Object(S.s)("currency"):"INR"};y.a.post("".concat(f.d,"/paytm/subscription/initiateSubscription"),o,{headers:{"Content-Type":"application/json"}}).then(function(){var e=Object(c.a)(r.a.mark(function e(a){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:1==a.data.statusId&&(t={orderId:a.data.result.orderId,subcriptionid:a.data.result.subcriptionid,cb:"/paymentInitiated",amountType:"FIX",transactionAmt:a.data.result.transactionAmt,transactionCurrency:a.data.result.transactionCurrency,subscriptionEnableRetry:1,email:a.data.result.email,mobile:a.data.result.mobile,custId:a.data.result.custId,paymentMode:"CC"},y.a.post("".concat(f.d,"/paytm/createOrder"),t,{headers:{"Content-Type":"application/json"}}).then(function(){var e=Object(c.a)(r.a.mark(function e(a){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("createOrder: ",a.data),n.setState({docContent:a.data});case 2:case"end":return e.stop()}},e)}));return function(a){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));return function(a){return e.apply(this,arguments)}}())}},{key:"netBankingSubmit",value:function(e,a,t){var n=this;console.log(t),_()(".err").addClass("d-none").removeClass("d-block alert alert-danger");var o=this.props.package_id,s={sellerid:JSON.parse(this.props.user.sellerid),name:this.props.user.name?this.props.user.name:"Guest",email:this.props.user.email,mobile:this.props.user.mobile,benefName:e.benefName,accNo:e.accNo,ifsc:e.ifsc,accType:e.accType,currency:this.props.currency,package_id:o,customerid:window.location.pathname.split("/")[2],paymentMethod:t,auth_type:a};console.log(s,228),y.a.post("".concat(f.d,"/api/membership/emandate/createOrder"),s,{headers:{"Content-Type":"application/json"}}).then(function(){var e=Object(c.a)(r.a.mark(function e(t){var o,s,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"physical"===a&&(o=t.data.response.token.nach.prefilled_form,window.open(o)),console.log(t,235),n.props.currency,s={key:t.data.key_id,order_id:t.data.order_id,customer_id:t.data.customerid,recurring:"1",name:"Beldara.com",description:"Beldara Monthly Subscription",image:"https://img.beldara.com/images/BelDara-logo.png",handler:function(e){var a=this,n={payment_id:e.razorpay_payment_id,order_id:t.data.order_id,sellerid:w.a.get("sellerid")};y.a.post("".concat(f.d,"/api/membership/emandate/fetchToken"),n).then(function(){var e=Object(c.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("token",t,268,"inside fetchtoken api"),a.setState({is_subscribed:!0});case 2:case"end":return e.stop()}},e)}));return function(a){return e.apply(this,arguments)}}())}.bind(n),theme:{color:"#F37254"}},i=new window.Razorpay(s),e.next=7,i.open();case 7:case"end":return e.stop()}},e)}));return function(a){return e.apply(this,arguments)}}()).catch(function(e){var a=e.response;return console.log(a,e,358),void 0!==a&&(500===a.status?a.data.error&&(_()(".err").addClass("d-block alert alert-danger").removeClass("d-none").text(a.data.error.description),setTimeout(function(){_()(".err").addClass("d-none").removeClass("d-block alert alert-danger")},5e3)):400===a.status&&a.data.error&&(_()(".err").addClass("d-block alert alert-danger").removeClass("d-none").text(a.data.error.description),setTimeout(function(){_()(".err").addClass("d-none").removeClass("d-block alert alert-danger")},5e3))),Promise.reject(a)})}},{key:"render",value:function(){var e=this;return p.a.createElement(p.a.Fragment,null,p.a.createElement("div",{className:"container py-5"},p.a.createElement("div",{className:"row mb-1"},p.a.createElement("div",{className:"col-lg-8 mx-auto text-left"},p.a.createElement("h4",{className:"display-4"},"Monthly Plan"),this.state.is_subscribed?p.a.createElement("div",{className:"justify-content-center text-center alert alert-success"},"Your subscription initiated successfully"):"")),this.state.docContent&&""!==this.state.docContent&&p.a.createElement("div",{className:"paytmdoc",dangerouslySetInnerHTML:{__html:this.state.docContent}}),p.a.createElement("div",{className:"row"},p.a.createElement("div",{className:"col-lg-8 mx-auto p-0"},p.a.createElement("div",{className:"card border-0 shadow-sm"},p.a.createElement("div",{className:"card-header"},p.a.createElement("div",{className:"col-12 mb-2"},"Select options to pay"),p.a.createElement("div",{className:"bg-white shadow-sm pt-4 pl-2 pr-2 pb-2"},p.a.createElement("ul",{role:"tablist",className:"nav bg-light nav-pills rounded nav-fill mb-3"},p.a.createElement("li",{className:"nav-item"}," ",p.a.createElement("a",{"data-toggle":"pill",href:"#credit-card",className:"nav-link active "}," ",p.a.createElement("i",{className:"fa fa-credit-card mr-2"})," Credit Card ")," "),p.a.createElement("li",{className:"nav-item"}," ",p.a.createElement("a",{"data-toggle":"pill",href:"#paypal",className:"nav-link "}," ",p.a.createElement("i",{className:"fa fa-money-check mr-2"})," Netbanking ")," "))),p.a.createElement("div",{className:"tab-content"},p.a.createElement("div",{id:"credit-card",className:"tab-pane fade show active pt-3 text-center"},p.a.createElement("button",{className:"btn getLogin btn-primary",id:"monthly-subs",onClick:this.openCheckout},"Choose Monthly Subscription")),p.a.createElement("div",{id:"paypal",className:"tab-pane fade pt-3"},p.a.createElement(b.a,{initialValues:{benefName:"",accNo:"",ifsc:"",accType:"",mobile:"",email:"",paymentGroup:"razorpay"},validationSchema:k.a({benefName:k.b().required("Required"),accNo:k.b().required("Required"),accType:k.b().required("Required"),ifsc:k.b().required("Required"),paymentGroup:k.b().required("Required")}),onSubmit:function(a,t){var n=t.setSubmitting;console.log("onSubmit: ",a),"paytm"==a.paymentGroup?e.paytmPayment(a,"netbanking",O):e.netBankingSubmit(a,"netbanking",O),n(!1)}},function(e){var a=e.values,t=e.errors,n=e.touched,r=e.handleChange,c=e.handleBlur,o=e.handleSubmit,s=e.isSubmitting;e.setFieldValue;return p.a.createElement("form",{onSubmit:o},p.a.createElement("p",{className:"error d-none"}),p.a.createElement("div",{className:"form-label-group"},p.a.createElement("input",{type:"text",name:"benefName",id:"benefName",onChange:r,onBlur:c,value:a.benefName,className:"form-control",placeholder:"Account Holder name"}),p.a.createElement("label",{htmlFor:"benefName"},"Account Holder name"),t.benefName&&n.benefName&&t.benefName),p.a.createElement("div",{className:"form-label-group"},p.a.createElement("input",{type:"text",name:"accNo",id:"accNo",onChange:r,onBlur:c,value:a.accNo,className:"form-control",placeholder:"Bank Account number"}),p.a.createElement("label",{htmlFor:"accNo"},"Bank Account number"),t.accNo&&n.accNo&&t.accNo),p.a.createElement("div",{className:"row"},p.a.createElement("div",{className:"col"},p.a.createElement("div",{className:"form-label-group "},p.a.createElement("input",{type:"text",name:"ifsc",id:"ifsc",onChange:r,onBlur:c,value:a.ifsc,className:"form-control",placeholder:"IFSC Code"}),p.a.createElement("label",{htmlFor:"ifsc"},"IFSC Code"),t.ifsc&&n.ifsc&&t.ifsc)),p.a.createElement("div",{className:"col"},p.a.createElement("div",{className:"form-label-group "},p.a.createElement(N.a,{onBlur:c,onChange:function(e){a.accType=e.value},isSearchable:!1,options:j,name:a.accType,value:j?j.find(function(e){return e.value===a.accType}):"",placeholder:"Account Type"}),t.accType&&n.accType&&t.accType))),p.a.createElement("div",{className:"payment-options"},p.a.createElement("ul",null,p.a.createElement("li",{className:"d-block"},p.a.createElement("div",{className:"radio-option razorpay"},p.a.createElement("input",{type:"radio",name:"paymentGroup",value:"razorpay",method:"razorpay",id:"razorpay",onChange:r,defaultChecked:!0}),p.a.createElement("label",{className:"ml-2",htmlFor:"razorpay"},"Pay using Credit / Debit Card"))))),p.a.createElement("button",{type:"submit",className:"btn btn-primary form-control",disabled:s},"Submit"),p.a.createElement("div",{className:"err d-none"}))}))))),p.a.createElement("div",{className:"alert alert-light border-0 shadow-sm",style:{background:"#00000008"}},p.a.createElement("i",{className:"fa fa-check-circle mr-2 fa-lg text-success"})," 100% Secure payments powered by Beldara")))))}}]),a}(u.Component);a.default=Object(g.connect)(function(e){return{currency:e.data.symbol,user:e.user.user}})(T)}}]);
//# sourceMappingURL=106.2d407593.chunk.js.map