{"version":3,"sources":["components/razorpayForm/monthlySub.jsx"],"names":["MonthlySub","props","_this","Object","_Volumes_NITIN_PATIL_Latest_Working_Project_react_beldara_com_13_08_20_theme_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__","this","_Volumes_NITIN_PATIL_Latest_Working_Project_react_beldara_com_13_08_20_theme_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__","_Volumes_NITIN_PATIL_Latest_Working_Project_react_beldara_com_13_08_20_theme_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__","call","state","currency","openCheckout","bind","_Volumes_NITIN_PATIL_Latest_Working_Project_react_beldara_com_13_08_20_theme_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_7__","processTranscation","script","document","createElement","src","async","body","appendChild","_this2","readTnc","readTncThenBuy","ls","get","package_id","passData","sellerid","amount","axios","post","concat","localhost","then","_ref","_Volumes_NITIN_PATIL_Latest_Working_Project_react_beldara_com_13_08_20_theme_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__","_Volumes_NITIN_PATIL_Latest_Working_Project_react_beldara_com_13_08_20_theme_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","a","mark","_callee3","response","data","mobile","email","name","options","wrap","_context3","prev","next","status","window","location","reload","console","log","user","sent","key","key_id","subscription_id","description","image","handler","payment_id","razorpay_payment_id","razorpay_subscription_id","localStorage","getItem","_ref2","_callee2","_context2","ApiUrl","headers","Content-Type","_ref3","_callee","_context","stop","_x3","apply","arguments","catch","error","result","Promise","reject","_x2","prefill","theme","color","Razorpay","open","_x","openLoginModal","JSON","parse","_ref4","_callee4","_context4","href","id","_x4","react__WEBPACK_IMPORTED_MODULE_8___default","className","onClick","Component","withRouter","connect","symbol"],"mappings":"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","file":"static/js/24.9d2077c4.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport $ from 'jquery'\nimport { connect } from 'react-redux';\nimport axios from 'axios';\nimport ls from \"local-storage\";\nimport { localhost } from '../../constants/variable';\nimport { ImgUrl, ApiUrl } from '../../constants/ActionTypes';\nimport { Link, Redirect } from 'react-router-dom';\nimport { withRouter } from \"react-router-dom\";\n\nvar sellerid, currency;\nclass MonthlySub extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            currency: ''\n        }\n        this.openCheckout = this.openCheckout.bind(this);\n        this.processTranscation = this.processTranscation.bind(this);\n    }\n    componentDidMount() {\n        const script = document.createElement(\"script\");\n        script.src = \"https://checkout.razorpay.com/v1/checkout.js\";\n        script.async = true;\n        document.body.appendChild(script);\n    }\n    openCheckout() {\n        if (this.props.readTnc === false)\n            this.props.readTncThenBuy()\n        else {\n            let sellerid = ls.get('sellerid')\n            let package_id = this.props.package_id\n            \n            if (ls.get('sellerid')) {\n                if (this.props.currency === 'INR') {\n                    currency = this.props.currency;\n                }\n                else {\n                    currency = this.props.currency;\n                }\n                let passData = {\n                    currency: currency,\n                    sellerid: ls.get('sellerid'),\n                    amount: this.props.amount\n                }\n                axios.post(\n                    `${localhost}/api/membership/createSubscription`,\n                    passData\n                )\n                .then(async response => {\n                    if (response.status === 201) {\n                        window.location.reload()\n                    }\n                    console.log(response)\n                    let data = response.data\n                    let mobile = this.props.user.mobile\n                    let email = await this.props.user.email\n                    let name = this.props.user.name\n                    let options = {\n                        \"key\": data.key_id,\n                        \"subscription_id\": data.subscription_id,\n                        \"name\": \"Beldara.com\",\n                        \"description\": \"Beldara Monthly Subscription\",\n                        \"image\": \"https://img.beldara.com/images/BelDara-logo.png\",\n                        \"handler\": function (response) {\n                            console.log(response)\n                            let passData = {\n                                payment_id: response.razorpay_payment_id,\n                                subscription_id: response.razorpay_subscription_id,\n                                package_id: package_id,\n                                sellerid: localStorage.getItem('sellerid')\n                            }\n                            axios.post(\n                                `${localhost}/api/membership/successSubscription`,\n                                passData\n                            ).then(async response => {\n                                console.log(response)\n                                axios.post(\n                                    `${ApiUrl}/common/send_invoice.php`,\n                                    passData, { headers: { \"Content-Type\": \"multipart/form-data\" } }\n                                ).then(async response => {\n                                    // if(response.data) {}\n                                    window.location.reload()\n                                    console.log(response)\n                                })\n                                .catch(error => {\n                                    const result = error.response;\n                                    return Promise.reject(result);\n                                })\n                            })\n                            .catch(error => {\n                                const result = error.response;\n                                return Promise.reject(result);\n                            })\n                        },\n                        \"prefill\": {\n                            \"name\": name,\n                            \"email\": email,\n                            \"mobile\": mobile\n                        },\n                        \"theme\": {\n                            \"color\": \"#F37254\"\n                        }\n                    };\n                    let rzp = new window.Razorpay(options);\n                    rzp.open();\n                })\n                .catch(error => {\n                    console.log('error', error)\n                    const result = error.response;\n                    return Promise.reject(result);\n                });\n\n            }\n            else {\n                this.props.openLoginModal()\n            }\n        }\n    }\n    processTranscation(){\n        if (this.props.readTnc === false)\n            return this.props.readTncThenBuy()\n            console.log('monthly sub', ls.get('sellerid'))\n            if (ls.get('sellerid')){\n        let passData = {\n            name: this.props.user.name,\n            email: this.props.user.email,\n            mobile: this.props.user.mobile,\n            sellerid: ls.get('sellerid') ? JSON.parse(ls.get('sellerid')) : ls.get('sellerid')\n        }\n       \n        axios.post(\n            `${localhost}/api/membership/emandate/createCustomerId`,\n            passData,\n            {headers:{'Content-Type':'application/json'}}\n        )\n        .then(async response => {\n            console.log(response)\n            // this.props.history.push('/processtranscation');\n            window.location.href = '/processtranscation' + '/'+response.data.id;\n            // this.props.history.push({\n            //     pathname: '/processtranscation' + '/'+response.data.id,\n            // });\n            // let data = {\n            //     currency: this.props.currency,\n            //     amount: this.props.amount,\n            //     customer_id: response.data.id\n            // }\n            // axios.post(\n            //     `${localhost}/api/membership/createOrder`,\n            //     data,{headers:{'Content-Type':'application/json'}}\n            // )\n            // .then(async response => {\n            //     console.log(response)\n            // })\n            // .catch(error => {\n            //     const result = error.response;\n            //     return Promise.reject(result);\n            // });\n\n        }) \n        .catch(error => {\n            const result = error.response;\n            return Promise.reject(result);\n        });\n    }else {\n        this.props.openLoginModal()\n    }\n    }\n    \n\n    render() {\n        console.log(this.props)\n        return (\n            <div className=\"justify-content-center text-center\">\n                {\n                    // this.state.redProTrans && \n                    // <Redirect to=\"/processTranscation\"\n                }\n                {/* <button className=\"btn getLogin\" onClick={this.openCheckout} id=\"monthly-subs\">\n                    Choose Monthly Subscription\n                </button> */}\n                <button className=\"btn getLogin\" onClick={this.processTranscation} id=\"monthly-subs\">\n                    Choose Monthly Subscription\n                </button>\n                {/* <Link to='/login' params={{ type: \"order\" }}>\n                    <button className=\"btn getLogin\" id=\"monthly-subs\">\n                        Choose Monthly Subscription\n                    </button>\n                </Link> */}\n                {/* <div id=\"monthly\"></div> */}\n\n            </div>\n        )\n    }\n}\n\nconst mapStateToProps = state => ({\n    currency: state.data.symbol,\n    user: state.user.user\n});\n\nexport default withRouter(connect(mapStateToProps)(MonthlySub));"],"sourceRoot":""}